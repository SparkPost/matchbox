# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: test

on:
  pull_request
  push:
    branches: [master]
  

jobs:
  testing:
    runs-on: ubuntu-latest
    timeout-minutes: 30

    strategy:
      matrix:
        node-version: [10.x]

    steps:
      - uses: actions/checkout@v2
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}
      - run: npm ci
      - run: npm run test:ci


# name: Unit and end-to-end testing

# on: [pull_request]

# jobs:
#   testing:
#     runs-on: ubuntu-16.04
#     timeout-minutes: 30
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v1
#       - uses: actions/setup-node@v1
#         with:
#           node-version: '10.x'
#       - name: Install dependencies
#         uses: bahmutov/npm-install@v1
#       - name: Testing
#         run: npm run test:ci
#       # Coveralls setup not complete
#       #   env:
#       #     COVERALLS_REPO_TOKEN: ${{ secrets.COVERALLS_REPO_TOKEN }}
#       #     COVERALLS_GIT_BRANCH: ${{ github.ref }}
#       # - name: Upload Code Coverage
#       #   uses: coverallsapp/github-action@master
#       #   with:
#       #     github-token: ${{ secrets.GITHUB_TOKEN }}
#       - name: Upload artifacts
#         uses: actions/upload-artifact@v1
#         if: failure()
#         with:
#           name: Cypress Videos
#           path: /home/runner/work/matchbox/matchbox/cypress/videos/
